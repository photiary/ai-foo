# 음식 이미지 분석 개인 맞춤 서비스

# API 수정

## 음식 이미지 분석 요청 수정

수정 API: /v1/food/analysis

AS-IS: 식사 이미지를 분석하여 사용자 상태에 따라 제안
TO-BE: 이미지만 분석할 경우 토큰 사용량을 분석하기 위해 옵션에 따라 기능을 다음과 같이 분리한다.

1. 식사 이미지만 분석
   - 이미지만 분석하므로 사용자 상태정보를 받지 않는다.
   - 페르소나: 식사 이미지를 잘 분석할 수 있도록 페르소나를 지정한다.
   - 사용자 프롬프트:
   ```
     식사 이미지 데이터 URI를 참고하여, 다음 정보를 JSON으로만 응답하라.
     - 음식 리스트
     - 이미지에서의 위치 중심 좌표(position: {x, y})
   ```
   - 응답 구조 스키마
     - 식사 이미지를 분석한 음식의 리스트
     - 이미지에서의 위치(x, y)
     - `food-analysis-schema.json`와 같은 항목은 동일한 구조를 유지한다.

2. 식사 이미지 분석 + 사용자 상태에 따라 제안
     - 기존 페르소사, 프롬프트, food-analysis-schema.json 유지한다. 

- RequestBody 추가항목:
  - analysisMode: String 식사 이미지 분석만 | 식사 이미지 분석과 사용자 상태에 따라 제안

### Entity

analysisMode는 `Enum`으로 관리한다.

- Entity: AnalysisFood 추가항목
  - analysisMode: 분석 범위

### Refactoring

기능 수정 작업 완료 후, "1. 식사 이미지만 분석"와 "2. 식사 이미지 분석 + 사용자 상태에 따라 제안" 기능에서 중복된 리소스나 더 나은 리소스 구조가 있는 경우는 릭팩토링 하시오.

